name: empire-md

services:
  - name: empire-service
    type: web
    build:
      type: nodejs
    routes:
      - name: main
        path: /
        port: 8000
    entrypoint:
      - "pm2"
      - "start"
      - "index.js"
      - "--no-daemon"
    command:
      - "npm install"  # Replace npm ci with npm install
      - "pm2"
      - "start"
      - "index.js"
      - "--deep-monitoring"
      - "--attach"
      - "--name"
      - "empire-md"
    args:
      - "--no-daemon"
    working_directory: /app
    volumes:
      - ./app:/app
    build:
      context: .
